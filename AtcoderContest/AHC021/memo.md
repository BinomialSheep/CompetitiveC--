15:00
電車内で問題を見る。
BinarySheepのO(N)の構築がスタートだよなぁと思う。
得点計算を見るに、ソートをサボる選択肢はないらしい。

15:20
最寄り駅到着。スタバに並ぶ。
ヒープのO(N)構築ベース＋天才ルール＋乱択が本命かな。
でもあえて1周目で構築を完成させない方が点数いいことはあるのかな。
1周目はDFSで先読みして1番少ない回数swapして、2周目以降で完成させるみたいな。

15:40
自宅到着してコンテストに参加。

16:00
とりあえず自明なソート完成解を書く。
雑に100回くらい下から見れば完成する。
1240万点くらい。順位表を見ると近くに沢山いる。

17:10
DFSして先読みを試してみた。
1267万点。

17:30
ヒープO(N)解を書く。
1306万点。こっちの方がいいらしいのでこの方針。

17:50
下から作るとして、右から見るか左から見るかは自明じゃない。
時間めいっぱい乱択をする。1309.4万点。

ここで考える。
現在の1位は1356万点で、1回あたり500回以上の操作回数差があるらしい。
また、上位を見るとアルゴ勢の比率が高く、マラソン勢はあまり無双していない。
オンサイト予選だからもあるかもだけど、上手い乱択よりも天才ルール問題なことを示唆していそう。

18:05
観察すると、大きい方から操作する方が大体良さそうなことが分かる。
 4 3
1 2 5
1行目を右から見ると2回操作が必要だが、左からだと1回で済む。
行ごとにソートして、行内部では大きい方から実行。
1309.7万点。
乱択と合わせて1309.9万点。

18:30
ところでsquareさんが開始5分で1334万点解を出している。
なんかよく知られた天才ルールがあるのかな。
それともsquareさんが天才なだけかな。

18:50
下の行から見る前に、大きな値を下に寄せておいた方がよくなる可能性がある。
ただし単純に大きい方から全部見ると無駄が大きいので、
- 全体で大きい方からM個を先にDFSで目一杯swapする
 - Mは全探索する
- 下の行からO(N)のヒープ構築をする
 - この時、行の中では値が大きい順にDFSする
- オマケで適当に乱択する
 - 大きい方からM個のうちいくつかDFSしない
 - 行の中で降順ソートしたあと適当にswap
これで1319.4万点

19:00
323位(1568パフォ)らしい。
難しいね。

